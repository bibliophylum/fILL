<TMPL_INCLUDE NAME="header.tmpl">
<TMPL_INCLUDE NAME="submenu_lend.tmpl">

<link type="text/css" href="/css/maplin-theme/jquery-ui-1.8.16.custom.css" rel="stylesheet" />
<script type="text/javascript" src="/jquery-1.7.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>



<script type="text/javascript">
  function toggleLayer( whichLayer )
  {
    var elem, vis;
    if( document.getElementById ) // this is the way the standards work
      elem = document.getElementById( whichLayer );
    else if( document.all ) // this is the way old msie versions work
      elem = document.all[whichLayer];
    else if( document.layers ) // this is the way nn4 works
      elem = document.layers[whichLayer];

    vis = elem.style;
    // if the style.display value is blank we try to figure it out here
    if(vis.display==''&&elem.offsetWidth!=undefined&&elem.offsetHeight!=undefined)
      vis.display = (elem.offsetWidth!=0&&elem.offsetHeight!=0)?'block':'none';
    vis.display = (vis.display==''||vis.display=='block')?'none':'block';
  }
</script>

<script language="JavaScript">

$('document').ready(function() {

  function set_primary_tab(tab_id) {
    document.getElementById(tab_id).className='current_tab';
  }

  function set_secondary_tab(tab_id) {
    document.getElementById(tab_id).className='current_tab';
  }

  set_secondary_tab("menu_lend_pull");

  $.getJSON('/cgi-bin/get-menu-lend-counts.cgi', {lid: <TMPL_VAR name="lid">},
      function(data){
          if (data.counts.renewalRequests > 0) {
              $('#menu_lend_renewal_requests a')[0].innerHTML = 'Renewal requests: '+data.counts.renewalRequests;
          };
          if (data.counts.waiting > 0) {
              $('#menu_lend_respond a')[0].innerHTML = 'Respond: '+data.counts.waiting;
          };
          //alert('get-menu-lend-counts\nrenewalRequests: '+data.counts.renewalRequests+'\nwaiting: '+data.counts.waiting);
  });
});

</script>

<div id="main">

  <div id="middlecontent">
    <h3>Pull list</h3>
    <table id="gradient-style">
      <thead>
	<tr><th>Call #</th><th>Author</th><th>Title</th><th>Date/Time requested</th><th>Requested by</th><th>Requested by (ID)</th><th>Library barcode</th><th>Scanable barcode</th></tr>
      </thead>
      <tfoot><tr><td colspan="8">You can print this and take it to the stacks.</td></tr></tfoot>
      <tbody>
      <TMPL_LOOP name="pulls">
	<tr>
	  <td><TMPL_VAR NAME="call_number"></td>
	  <td><TMPL_VAR NAME="author"></td>
	  <td><TMPL_VAR NAME="title"></td>
	  <td><TMPL_VAR NAME="ts"></td>
	  <td><TMPL_VAR NAME="from"></td>
	  <td><TMPL_VAR NAME="msg_from"></td>
	  <td><TMPL_VAR NAME="barcode"></td>
	  <td><img src="data:image/png;base64,<TMPL_VAR NAME="barcode_image">"/></td>
	</tr>
      </TMPL_LOOP>
      </tbody>
    </table>
    
  </div>

</div>

<TMPL_INCLUDE NAME="footer.tmpl">
