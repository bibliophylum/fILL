<TMPL_INCLUDE NAME="header.tmpl">
<TMPL_INCLUDE NAME="submenu_borrow.tmpl">

<script type="text/javascript">
  function toggleLayer( whichLayer )
  {
    var elem, vis;
    if( document.getElementById ) // this is the way the standards work
      elem = document.getElementById( whichLayer );
    else if( document.all ) // this is the way old msie versions work
      elem = document.all[whichLayer];
    else if( document.layers ) // this is the way nn4 works
      elem = document.layers[whichLayer];

    vis = elem.style;
    // if the style.display value is blank we try to figure it out here
    if(vis.display==''&&elem.offsetWidth!=undefined&&elem.offsetHeight!=undefined)
      vis.display = (elem.offsetWidth!=0&&elem.offsetHeight!=0)?'block':'none';
    vis.display = (vis.display==''||vis.display=='block')?'none':'block';
  }
</script>

<div id="main">

<div id="quick_links">
  <a class="newsearch" href="?rm=search_common_form">New search...</a> | 

  <TMPL_IF NAME="SORTED_BY_TITLE">
    <p>Sorted by title</p>
    <a href="?rm=results_form&sort=author">Sort by author...</a>
  <TMPL_ELSE>
    <a href="?rm=results_form&sort=title">Sort by title...</a>
    <p>Sorted by author</p>
  </TMPL_IF>
</div>

<div id="results_fields">
</div>

<div id="undo_limits">
  Undo a limit:
  <TMPL_LOOP NAME="UNDO_LIMITS">
    [<a href="?rm=results_form&unlimit=<TMPL_VAR ESCAPE=URL NAME=undo_limit>">
      <TMPL_VAR NAME=unlimit>
    </a>]
  </TMPL_LOOP>
</div>


<div id="leftcontent">
  <h3>Limits</h3>
  <div id="limit_authors_hidden">
    <a href="#" onclick="toggleLayer('limit_authors_shown');toggleLayer('limit_authors_hidden');return false;" title="Limit your results to authors in this list">+Authors</a>
  </div>
  <div id="limit_authors_shown">
    <a href="#" onclick="toggleLayer('limit_authors_shown');toggleLayer('limit_authors_hidden');return false;" title="Hide the list of Author limits">-Authors</a>
    <TMPL_LOOP NAME="AUTHORS">
      <br>
      <a class="limits" href="?rm=results_form&limit=<TMPL_VAR ESCAPE=URL NAME=a_limit>">
	<TMPL_VAR NAME="author">
      </a>
    </TMPL_LOOP>
  </div>
  
  <div id="limit_subjects_hidden">
    <a href="#" onclick="toggleLayer('limit_subjects_shown');toggleLayer('limit_subjects_hidden');return false;" title="Limit your results to subjects in this list">+Subjects</a>
  </div>
  <div id="limit_subjects_shown">
    <a href="#" onclick="toggleLayer('limit_subjects_shown');toggleLayer('limit_subjects_hidden');return false;" title="Hide the list of Subject limits">-Subjects</a>
    <TMPL_LOOP NAME="SUBJECTS">
      <br>
      <a class="limits" href="?rm=results_form&limit=<TMPL_VAR ESCAPE=URL NAME=s_limit>">
	<TMPL_VAR NAME="subject">
      </a> 
    </TMPL_LOOP>
  </div>
  
  <div id="limit_pubdates_hidden">
    <a href="#" onclick="toggleLayer('limit_pubdates_shown');toggleLayer('limit_pubdates_hidden');return false;" title="Limit your results to publication dates in this list">+Publication Date</a>
  </div>
  <div id="limit_pubdates_shown">
    <a href="#" onclick="toggleLayer('limit_pubdates_shown');toggleLayer('limit_pubdates_hidden');return false;" title="Hide the list of Publication Date limits">-Publication Date</a>
    <TMPL_LOOP NAME="PUBDATES">
      <br>
      <a class="limits" href="?rm=results_form&limit=<TMPL_VAR ESCAPE=URL NAME=pd_limit>">
	<TMPL_VAR NAME="pubdate">
      </a>
    </TMPL_LOOP>
  </div>
  
</div>

<div id="middlecontent">
  <TMPL_VAR NAME="count"> record(s) found.
    <p class="short_instruction">Records from different libraries are matched on ISBN.</p>
  <div id="search_results">
    <TMPL_LOOP NAME="bibs">

      <TMPL_IF NAME="isVisible_Title">
	<div class="sr_title_line">
	  <div class="sr_title"><TMPL_VAR NAME="title"></div>
	  <TMPL_UNLESS NAME="is_ebook">
	    <div class="sr_request">[<a href="?rm=show_marc_form&id=<TMPL_VAR NAME=id>">MARC</a>]</div>
	  </TMPL_UNLESS>
	  <div class="spacer">&nbsp;</div> <!-- Need this because of the "float" divs -->
	</div>
      </TMPL_IF>

      <TMPL_IF NAME="isVisible_Author">
	<p class="search_results_author">Author: <TMPL_VAR NAME="author"></p>
      </TMPL_IF>

      <TMPL_IF NAME="isVisible_PubDate">
	<p class="search_results_pubdate">Published: <TMPL_VAR NAME="pubdate"></p>
      </TMPL_IF>

      <TMPL_IF NAME="isVisible_ISBN">
	<p class="search_results_pubdate">ISBN: <TMPL_VAR NAME="isbn"></p>
      </TMPL_IF>

      <TMPL_IF NAME="isVisible_Abstract">
	<p class="search_results_pubdate">Abstract: <TMPL_VAR NAME="abstract"></p>
      </TMPL_IF>

      <TMPL_IF NAME="isVisible_Subjects">
	<p class="search_results_subject_heading">Subjects:</p>
	<TMPL_LOOP NAME="search_results_subjects">
	  <p class="search_results_subject"><TMPL_VAR NAME="subject"></p>
	</TMPL_LOOP>
      </TMPL_IF>

      <TMPL_IF NAME="isVisible_Info">
	<p class="search_results_subject_heading">More information:</p>
	<TMPL_LOOP NAME="URLs">
	  <p class="search_results_subject">
	    <TMPL_VAR NAME="text">: <a href="<TMPL_VAR NAME=URL>"><TMPL_VAR NAME="url"></a>
	  </p>
	</TMPL_LOOP>
      </TMPL_IF>

      <TMPL_IF NAME="is_ebook">
        <TMPL_IF NAME="isVisible_Link">
	<p class="search_results_subject_heading">Download:</p>
	  <TMPL_LOOP NAME="ebooklinks">
	    <p class="search_results_subject">
	      Link: <a href="<TMPL_VAR NAME=ebooklink>"><TMPL_VAR NAME="ebooklink"></a>
	    </p>
	  </TMPL_LOOP>
	</TMPL_IF>
      <TMPL_ELSE>
	<TMPL_IF NAME="isVisible_Holdings">
	  <TMPL_LOOP NAME="holdings">
	    <p class="search_results_holdings">Location: <TMPL_VAR NAME="location">
		(<TMPL_VAR NAME="callno">,<TMPL_VAR NAME="collection">)
		  <em>Availability: <TMPL_VAR NAME="available"></em>
		  <a href="?rm=request_form&zid=<TMPL_VAR NAME=zid>&id=<TMPL_VAR NAME=record_id>&loc=<TMPL_VAR NAME=location>&callno=<TMPL_VAR NAME=callno>&collection=<TMPL_VAR NAME=collection>">Request this item</a>
<!--
		  <a href="?rm=canadapost_form&zid=<TMPL_VAR NAME=zid>&id=<TMPL_VAR NAME=record_id>&loc=<TMPL_VAR NAME=location>&callno=<TMPL_VAR NAME=callno>&collection=<TMPL_VAR NAME=collection>">Requesting disabled...</a>
-->
	    </p>
	    <!-- <p><TMPL_VAR NAME="sortable_nbnl"></p> -->
	    <TMPL_IF NAME="is_net_borrower">
	      <p class="search_results_holdings_location_netborrower">
		[Net borrower:
            <TMPL_ELSE>
	      <p class="search_results_holdings_location_netlender">
	        [Net lender:
	    </TMPL_IF>
	    <TMPL_VAR NAME="net_borrower_or_lender">]
            </p><br />
          </TMPL_LOOP>

	  <TMPL_UNLESS NAME="holdings_count">
	    <TMPL_IF NAME="handles_holdings_improperly">
	      <p class="short_instruction">This zServer does not return proper holdings information.</p>
	      <a href="?rm=request_form&zid=<TMPL_VAR NAME=zid>&id=<TMPL_VAR NAME=record_id>">Try to request from zServer owner...</a>
	    <TMPL_ELSE>
	      <p class="short_instruction">No holdings information.</p>
	      <a href="?rm=request_form&zid=<TMPL_VAR NAME=zid>&id=<TMPL_VAR NAME=record_id>">Request anyway...</a>	  
	    </TMPL_IF>
	  </TMPL_UNLESS>
        </TMPL_IF>
      </TMPL_IF>
      <!-- <p class="search_results_author">Found at server: <TMPL_VAR NAME="found_at_server"></p> -->

    </TMPL_LOOP>
  </div>
</div>


<div id="rightcontent">
  <h3>Fields</h3>

  <div id="ShownFields">
    <h4>Displayed</h4>
    <TMPL_LOOP NAME="Shown_Fields">
      <br>
      <a class="limits" href="?rm=results_form&isVisible_<TMPL_VAR NAME=name>=off">
	<TMPL_VAR NAME="name">
      </a>
    </TMPL_LOOP>
    <br /><p class="short_instruction">(Click field name to hide)</p>
  </div>
  
  <br /><br />

  <div id="HiddenFields">
    <h4>Not displayed</h4>
    <TMPL_LOOP NAME="Hidden_Fields">
      <br>
      <a class="limits" href="?rm=results_form&isVisible_<TMPL_VAR NAME=name>=on">
	<TMPL_VAR NAME="name">
      </a>
    </TMPL_LOOP>
    <br /><p class="short_instruction">(Click field name to show)</p>
  </div>
  
</div>

</div>

<TMPL_INCLUDE NAME="footer.tmpl">
