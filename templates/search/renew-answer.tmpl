<TMPL_INCLUDE NAME="header.tmpl">
<TMPL_INCLUDE NAME="submenu_lend.tmpl">

<link type="text/css" href="/css/maplin-theme/jquery-ui-1.8.16.custom.css" rel="stylesheet" />
<script type="text/javascript" src="/jquery-1.7.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script type="text/javascript" src="/menu-counters.js"></script>
<script type="text/javascript" src="/renewal-answer.js"></script>


<script type="text/javascript">
set_secondary_tab("menu_lend_renewal_requests");

$.ajaxSetup ({  
  cache: false  
});  

$('document').ready(function(){

    $.getJSON('/cgi-bin/get-renewal-requests.cgi', {lid: <TMPL_VAR name="lid">},
            function(data){
                //console.log(data.renewRequests[0].id);
                //console.log(data.renewRequests[0].title);
                //alert(data); //uncomment this for debug
                //alert (data.renewRequests[0].id+" "+data.renewRequests[0].msg_from+" "+data.renewRequests[0].call_number+" "+data.renewRequests[0].author+" "+data.renewRequests[0].title+" "+data.renewRequests[0].ts); //further debug
                build_table(data);
                //toggleLayer("waitDiv");
                //toggleLayer("mylistDiv");
           });

    $(function() {
           $( "#datepicker" ).datepicker({ dateFormat: 'yy-mm-dd' });
    });

    $(function() {
           update_menu_counters( <TMPL_VAR name="lid"> );
    });

});

</script>


<div id="main">

  <div id="leftcontent">
    <h2>Instructions</h2>
    <ol>
      <li>If your due date is the same for all (or most) requests you are renewing, enter that as the "default due date".</li>
      <li>For each of the requests that you are renewing, click the "Renew OK" button.</li>
      <li>For each remaining request - those that will be unfilled - click the "Can't renew".</li>
    </ol>
  </div>

  <div id="middlecontent">

    <div id="waitDiv">
      Loading... <img src="/wait.gif">
    </div>

    <div id="myDiv">
      <h3>1. Set a default due date</h3>
      <div id="defaultDueDate">
	<form id="set_default_due_date" onsubmit="set_default_due_date(this); this.submit_default_due_date.value='Change default'; return false;">
<!--
	  Year: <input type="text" size="4" maxlength="4" name="year" value="2011">
	  Month: <input type="text" size="2" maxlength="2" name="month" value="11">
	  Day: <input type="text" size="2" maxlength="2" name="day" value="28">
-->
	  <p>
	    Date (yyyy-mm-dd): <input id="datepicker" type="text">
	    <input type="submit" name="submit_default_due_date" value="Set as default"/>
	  </p>
	</form>
      </div>

      <br/>
      <h3>2. Respond to renewal requests</h3>
      <div id="mylistDiv"></div>
    </div>

  </div>

</div>

<TMPL_INCLUDE NAME="footer.tmpl">
